# 開発ルール

## 🚀 初期設定（新しい会話を開始したら必ず実行）

### 1. Serenaの初期設定を読み込む
```
/mcp__serena__initial_instructions
```
これを実行しないとSerenaが正しく動作しません。

### 2. プロジェクト構造を確認
- package.jsonまたはrequirements.txtの内容を確認
- srcディレクトリの構造を把握

## 📦 利用可能なMCPツール

### 基本ツール

1. **Serena** - コード検索・編集
   - 使用例: 「fetchUserData関数を見せて」
   - 使用例: 「Userクラスにvalidateメソッドを追加して」

2. **Context7** - 最新ドキュメント取得
   - 使用例: 「React 18の新機能を教えて」
   - 使用例: 「Next.js 14のApp Routerの使い方を教えて」

3. **Playwright** - ブラウザ自動化
   - 使用例: 「https://example.comのスクリーンショットを撮って」
   - 使用例: 「ログインフォームのE2Eテストを作成して」

### データ分析・機械学習向けツール

4. **MongoDB Atlas** - データベース連携
   - 使用例: 「MongoDBクラスターを作成して」
   - 使用例: 「プロジェクトの接続文字列を取得して」

5. **Pulse** - データ分析・可視化
   - 使用例: 「AWSの利用コストを分析して」
   - 使用例: 「株式市場データを集計して」

## 📝 基本ルール
- 絶対にフォールバック機能を実装しない
- サンプルデータの生成をしないこと
- ユーザーとは日本語で会話すること
- タスクを終えることは本番環境での動作を保証すること

## 💻 コーディング規約
- Pythonコードはtype hintを使用すること
- 関数には適切なdocstringを記述すること
- 変数名・関数名は日本語ではなく英語で記述すること

## ⚙️ 環境設定
- 環境変数はルート直下の.envファイルで管理
- ベクトルDBのパスはFAISS_STORE_DIRで指定

## 🧪 テスト方法
- 実装後は必ず`make serve`コマンドで動作確認を行うこと
- 各機能が正しく動作することを確認し、結果をログに残すこと
- Playwrightを使用してE2Eテストを実施すること

## 🚀 デプロイ
- 本番環境へのデプロイ前に統合テストを行うこと

## 💡 作業の流れ

### 新機能を実装する時
1. Context7で最新のベストプラクティスを確認
2. Serenaで既存コードの構造を分析
3. 実装
4. Playwrightでテスト作成
5. `make serve`で動作確認

### データ分析・機械学習タスクを実行する時
1. Serenaでデータ構造と処理コードを確認
2. MongoDB Atlasでデータベースの設定と接続
3. データ処理コードの実装や最適化
4. Pulseでデータ分析と可視化
5. Context7で最新のデータサイエンス手法を調査

### バグを修正する時
1. Serenaで問題のあるコードを検索
2. Context7で関連ドキュメントを確認
3. 修正を実装
4. テストを実行

### コードをリファクタリングする時
1. Serenaで影響範囲を調査
2. Context7で最新のパターンを確認
3. 段階的にリファクタリング
4. 各段階でテストを実行

## プロジェクト固有の注意事項
- MCPツールのエラーが発生した場合は、`/mcp restart [tool-name]`で再起動
- Serenaは新しい会話ごとに初期設定が必要
- 大規模な変更を行う前に、必ずバックアップブランチを作成